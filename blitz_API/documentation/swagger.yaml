openapi: '3.0.2'
info:
  title: BLITZ APP
  version: '1.0'
servers:
  - url: http://localhost:3000/api/v1
tags:
  - name: Auth
    description: Authentication methods
  - name: Menu
    description: Restaurant menu API methods
  - name: Address
    description: client adresses API methods
  - name: User
    description: User management API methods
paths:
  /auth:
    post:
      tags:
       - Auth
      summary: Authentication
      description: Authentication requestBody
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/authBody'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/authResp'
  /user/create:
    post:
      tags:
        - User
      description: Create address
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/userCreate'
      responses:
        '200':
          description: Successful operation
  /user/{id}:
    get:
      tags:
        - User
      description: get user info by id
      parameters:
        -
          name: id
          in: path
          description: user id
          schema:
            type: string
          required: true
        -
          name: rol
          in: header
          description: this operation needs admin rol (1) given by token
          schema:
            type: number
          required: true
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getUser'      
  /user/:
    get:
      tags:
       - User
      description: Get all users
      parameters:
        -
          name: rol
          in: header
          description: this operation needs admin rol (1) given by token
          schema:
            type: number
          required: true
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getAllUsers'
  /user/{update_id}:
    put:
      tags:
        - User
      description: update user info by id
      parameters:
        -
          name: id
          in: path
          description: user id
          schema:
            type: string
          required: true
        -
          name: rol
          in: header
          description: this operation needs admin rol (1) given by token
          schema:
            type: number
          required: true
      security:
        - BearerToken: []
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/updateUser'
      responses:
        '200':
          description: Successful operation
  /user/{delete_id}:
    delete:
      tags:
        - User
      description: Delete a user by id
      parameters:
        -
          name: id
          in: path
          description: user id
          schema:
            type: string
          required: true
        -
          name: rol
          in: header
          description: this operation needs admin rol (1) given by token
          schema:
            type: number
          required: true
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation      
  /address/create:
    post:
      tags:
        - Address
      description: Create address
      requestBody:
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/addressCreate'
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
  /address/update={id}:
    put:
      tags:
        - Address
      description: Update Address field
      parameters:
        -
          name: id
          in: path
          schema:
            type: string
          required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/addressUpdate'
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
  /address:
    get:
      tags:
        - Address
      description: Get all addresses by user id   
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getAddresses'
  /address/delete={id}:
    delete:
      tags:
        - Address
      description: Get all addresses by user id
      parameters:
        -
          name: id
          in: path
          schema:
            type: string
          required: true
          description: address id
      security:
        - BearerToken: []
      responses:
        '200':
          description: Successful operation
  /menu:
    get:
      tags: 
        - Menu
      description: get all menu items
      security:
        - BearerToken: []
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getMenu'
              example: 
                msg: 'OK'
                data: 
                  -
                    category_id: 'hen7UfMh4Z3yE14Bexk9' 
                    description: 'Arroz cremoso con mix de mariscos.'
                    dish_name: 'Arroz marinero'
                    label_img: 'link here'
                    price: 30000
  /menu/update={id}:
    put:
      tags:
        - Menu
      description: update menu item by id
      security:
        - BearerToken: []
      parameters:
        - name: id
          in: path
          schema:
            type: string
          required: true
          description: dish id
        - name: rol
          in: header
          schema:
            type: number
          required: true
          description: this operation needs admin rol (1) given by token
          example: 1
      requestBody: 
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/putBody'
      responses: 
        '201':
          description: Successful operation
  /menu/create:
    post:
      tags:
        - Menu
      description: Create new menu item
      parameters:
        - name: rol
          in: header
          schema:
            type: number
          required: true
          description: this operation needs admin rol (1) given by token
          example: 1
      security:
        - BearerToken: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/createBody'
            example:
              category_id: 'hen7UfMh4Z3yE14Bexk9' 
              description: 'Arroz cremoso con mix de mariscos.'
              dish_name: 'Arroz marinero'
              label_img: 'link here'
              price: 30000
      responses:
        '201':
          description: Successful operation
  /menu/delete={id}:
    delete:
      tags:
        - Menu
      description: delete menu item by id
      security:
        - BearerToken: []
      parameters:
        -
          name: id
          in: path
          schema:
            type: string
          required: true
          description: dish id
        - name: rol
          in: header
          schema:
            type: number
          required: true
          description: this operation needs admin rol (1) given by token
          example: 1
      responses:
        '201':
          description: Successful operation
components:
  schemas:
    authBody:
      $ref: 'auth/body.yaml'
    authResp:
      $ref: 'auth/post.yaml'
    getMenu:
      $ref: 'menu/get.yaml'
    putBody:
      $ref: 'menu/put.yaml'
    createBody:
      $ref: 'menu/create.yaml'
    addressCreate:
      $ref: 'address/create.yaml'
    addressUpdate:
      $ref: 'address/update.yaml'
    getAddresses:
      $ref: 'address/get.yaml'
    userCreate:
      $ref: 'user/create.yaml'
    getUser:
      $ref: 'user/get.yaml'
    getAllUsers:
      $ref: 'user/getAll.yaml'
    updateUser:
      $ref: 'user/update.yaml'
  securitySchemes:
    BearerToken:
      type: http
      scheme: bearer

